{% extends "layout.html" %}
{% block body %}

        <!-- Registration page  -->
        <div class="mask d-flex align-items-center h-100 gradient-custom-3">
            <div class="container h-100">
                <div class="row d-flex justify-content-center align-items-center h-100">
                    <div class="col-12 col-md-9 col-lg-7 col-xl-6">
                        <div class="card" style="border-radius: 15px;">

                            <!-- --------------- Details Card ---------------------- -->
                            <div class="image_logo" style="padding:3% 0 0 0">
                                <img class=" mx-auto d-block" src="../static/images/login_logo.png" alt="" width="150"
                                    height="150">
                            </div>
                            <div class="card-body p-5">
                                <h2 class="text-uppercase text-center mb-5">Hello {{session['user_name']}}</h2>
                                <form action="/upload" method="post" >
                                    <label for="input-6a"></label>
                                    <div class="container">
                                        <h2 class="text-center mt-4 mb-4"></h2>
                                        <div class="card">
                                            <div class="card-header"><b>Select Excel File</b></div>
                                            <div class="card-body">

                                                <input type="file" id="excel_file" name="upload_file" />
                                                <input type="submit" value="Submit">

                                            </div>
                                        </div>
                                        <!-- <a href="/data"></a> -->
                                        <div id="excel_data" class="mt-5"></div>
                                        <iframe width="900" height="646" frameborder="0" scrolling="no" src="https://rawattech-my.sharepoint.com/personal/mohits_rawattech_com/_layouts/15/Doc.aspx?sourcedoc={1ba781a9-727b-414e-9a32-08b61cd84dfb}&action=embedview&wdAllowInteractivity=False&AllowTyping=True&wdHideHeaders=True&wdDownloadButton=True&wdInConfigurator=True"></iframe>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </section>
    <!-- JavaScript Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous">
    </script>


    <!-- <script>
        const excel_file = document.getElementById('excel_file');

        excel_file.addEventListener('change', (event) => {

            if (!['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                    'application/vnd.ms-excel'
                ].includes(event.target.files[0].type)) {
                document.getElementById('excel_data').innerHTML =
                    '<div class="alert alert-danger">Only .xlsx or .xls file format are allowed</div>';

                excel_file.value = '';

                return false;
            }

            var reader = new FileReader();

            reader.readAsArrayBuffer(event.target.files[0]);

            reader.onload = function (event) {

                var data = new Uint8Array(reader.result);

                var work_book = XLSX.read(data, {
                    type: 'array'
                });

                var sheet_name = work_book.SheetNames;

                var sheet_data = XLSX.utils.sheet_to_json(work_book.Sheets[sheet_name[0]], {
                    header: 1
                });

                if (sheet_data.length > 0) {
                    var table_output = '<table class="table table-striped table-bordered">';

                    for (var row = 0; row < sheet_data.length; row++) {

                        table_output += '<tr>';

                        for (var cell = 0; cell < sheet_data[row].length; cell++) {

                            if (row == 0) {

                                table_output += '<th>' + sheet_data[row][cell] + '</th>';

                            } else {

                                table_output += '<td>' + sheet_data[row][cell] + '</td>';

                            }

                        }

                        table_output += '</tr>';

                    }

                    table_output += '</table>';

                    document.getElementById('excel_data').innerHTML = table_output;
                }

                excel_file.value = '';

            }

        });
    </script> -->



</body>

</html>
{% endblock %}